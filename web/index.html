<!DOCTYPE html>
<html lang="pt-BR" class="dark">

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>MICROMON - ISP Command Center</title>
    <!-- Use a fixed version to avoid console warnings in some environments and for stability -->
    <script src="https://cdn.tailwindcss.com/3.4.1"></script>
    <link rel="icon"
        href="data:image/svg+xml,<svg xmlns=%22http://www.w3.org/2000/svg%22 viewBox=%220 0 100 100%22><text y=%22.9em%22 font-size=%2290%22>üì°</text></svg>">
    <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/xterm@5.3.0/css/xterm.css" />
    <script src="https://cdn.jsdelivr.net/npm/xterm@5.3.0/lib/xterm.js"></script>
    <script>
        tailwind.config = {
            darkMode: 'class',
            theme: {
                extend: {
                    colors: {
                        'brand-black': '#0a0a0a',
                        'brand-gray': '#1a1a1a',
                        'neon-green': '#00ff41',
                        'neon-red': '#ff0033',
                    },
                    fontFamily: {
                        mono: ['Courier New', 'monospace'],
                    }
                }
            }
        }
    </script>
    <style type="text/tailwindcss">
        @layer utilities {
            .scrollbar-hide::-webkit-scrollbar {
                display: none;
            }
        }
        body {
            @apply bg-brand-black text-gray-200 font-sans antialiased;
        }
        .terminal-text {
            @apply font-mono text-neon-green;
        }
        /* Xterm Customization */
        .xterm-viewport {
            overflow-y: auto !important;
        }
        /* Ensure hidden class works even if there's flex or other display rules */
        .hidden { display: none !important; }
    </style>
    <style>
        /* Logic Overrides - Outside Tailwind Processor */
        .page-content {
            display: none !important;
        }

        .page-content.active {
            display: block !important;
        }
    </style>
</head>

<body class="h-screen w-screen overflow-hidden flex flex-col">

    <!-- Login Screen -->
    <div id="login-screen" class="absolute inset-0 z-50 bg-brand-black flex items-center justify-center">
        <div class="w-full max-w-md p-8 bg-brand-gray border border-gray-800 rounded-lg shadow-2xl">
            <pre class="text-xs text-neon-green mb-6 text-center leading-3 font-bold">
 __  __ ___ ___ ___  ___  __  __  ___  _   _ 
|  \/  |_ _/ __| _ \/ _ \|  \/  |/ _ \| \ | |
| |\/| || | (__|   / (_) | |\/| | (_) |  \| |
|_|  |_|___\___|_|_\\___/|_|  |_|\___/|_| \_|
            </pre>
            <h2 class="text-center text-xl font-bold mb-6 tracking-wide uppercase text-gray-400">Acesso Restrito</h2>
            <form id="login-form" class="space-y-4">
                <div>
                    <label class="block text-xs font-mono text-gray-500 mb-1">USU√ÅRIO</label>
                    <input type="text" id="username"
                        class="w-full bg-black border border-gray-700 p-2 text-white focus:border-neon-green focus:outline-none transition-colors"
                        placeholder="admin">
                </div>
                <div>
                    <label class="block text-xs font-mono text-gray-500 mb-1">SENHA</label>
                    <input type="password" id="password"
                        class="w-full bg-black border border-gray-700 p-2 text-white focus:border-neon-green focus:outline-none transition-colors"
                        placeholder="‚Ä¢‚Ä¢‚Ä¢‚Ä¢‚Ä¢‚Ä¢‚Ä¢">
                </div>
                <button type="submit"
                    class="w-full bg-neon-green text-black font-bold py-2 mt-4 hover:bg-green-500 transition-transform active:scale-95">ENTRAR</button>
            </form>
            <div id="login-error" class="text-neon-red text-center mt-4 text-sm hidden">Acesso Negado</div>
        </div>
    </div>

    <!-- Main App (Hidden by default) -->
    <div id="app-container" class="hidden flex-1 flex h-full">

        <!-- Sidebar (unchanged structure, hidden overflow for clean look) -->
        <aside
            class="w-64 bg-brand-gray border-r border-gray-800 flex flex-col justify-between overflow-y-auto scrollbar-hide">
            <div>
                <div class="mb-8">
                    <h1 class="text-neon-green text-2xl font-black tracking-tighter">MICROMON</h1>
                    <p class="text-[10px] text-gray-500 font-mono uppercase tracking-widest leading-none">Central ISP
                        v1.1 <span class="text-neon-green">[FIXED]</span></p>
                </div>
                <nav class="p-4 space-y-2 services-nav">
                    <button
                        class="w-full text-left p-2 hover:bg-gray-800 rounded text-sm flex items-center gap-2 text-gray-300 hover:text-white"
                        onclick="showPage('olt')"><span>üì°</span> OLTs</button>
                    <button
                        class="w-full text-left p-2 hover:bg-gray-800 rounded text-sm flex items-center gap-2 text-gray-300 hover:text-white"
                        onclick="showPage('router')"><span>üîå</span> MikroTik</button>
                    <button
                        class="w-full text-left p-2 hover:bg-gray-800 rounded text-sm flex items-center gap-2 text-gray-300 hover:text-white"
                        onclick="showPage('switch')"><span>üñß</span> Switchs</button>
                    <button
                        class="w-full text-left p-2 hover:bg-gray-800 rounded text-sm flex items-center gap-2 text-gray-300 hover:text-white"
                        onclick="showPage('automation')"><span>ü§ñ</span> Automa√ß√£o</button>
                    <div class="border-t border-gray-800 my-2"></div>
                    <button
                        class="w-full text-left p-2 hover:bg-gray-800 rounded text-sm flex items-center gap-2 text-neon-green hover:text-white"
                        onclick="showPage('tech')"><span>üõ†Ô∏è</span> Portal T√©cnico</button>
                    <button
                        class="w-full text-left p-2 hover:bg-gray-800 rounded text-sm flex items-center gap-2 text-gray-300 hover:text-white"
                        onclick="showPage('inventory')"><span>üì¶</span> Equipamentos</button>
                    <button
                        class="w-full text-left p-2 hover:bg-gray-800 rounded text-sm flex items-center gap-2 text-gray-300 hover:text-white"
                        onclick="showPage('backups')"><span>üíæ</span> Backups</button>
                    <button
                        class="w-full text-left p-2 hover:bg-gray-800 rounded text-sm flex items-center gap-2 text-orange-400 hover:text-white"
                        onclick="showPage('logs')"><span>üìú</span> Logs do Sistema</button>
                    <button
                        class="w-full text-left p-2 hover:bg-gray-800 rounded text-sm flex items-center gap-2 text-purple-400 hover:text-white"
                        onclick="showPage('team')"><span>üë•</span> Equipe (Admin)</button>

                    <div id="nav-super-admin" class="hidden">
                        <div class="border-t border-gray-800 my-2"></div>
                        <button
                            class="w-full text-left p-2 hover:bg-yellow-900/40 rounded text-sm flex items-center gap-2 text-yellow-500 hover:text-white"
                            onclick="showPage('revenda')"><span>üíé</span> Painel de Revenda</button>
                    </div>
                </nav>
            </div>
            <div class="p-4 border-t border-gray-800">
                <div class="flex items-center gap-3">
                    <div class="w-8 h-8 rounded-full bg-gray-700 flex items-center justify-center font-bold text-xs"
                        id="avatar">AD</div>
                    <div>
                        <div class="text-sm font-bold" id="user-display">Admin</div>
                        <div class="text-xs text-neon-green">Conectado</div>
                    </div>
                </div>
                <div class="mt-3 flex flex-col gap-1">
                    <button onclick="logout()" class="text-[10px] text-red-500 hover:underline text-left">Encerrar
                        Sess√£o</button>
                </div>
            </div>
        </aside>

        <!-- Content Area -->
        <main id="main-content" class="flex-1 overflow-auto bg-brand-black relative p-6">

            <!-- Page: OLT -->
            <div id="page-olt" class="page-content">
                <div class="flex justify-between items-center mb-6 border-b border-gray-800 pb-2">
                    <h2 class="text-2xl font-bold">Interfaces OLT</h2>
                    <button onclick="openDeviceModal('OLT')"
                        class="bg-neon-green hover:bg-green-500 text-black px-3 py-1 rounded text-xs font-bold transition-all">+
                        Nova OLT</button>
                </div>
                <div id="olt-container" class="space-y-8">
                    <!-- Dynamic Content -->
                </div>
            </div>

            <!-- Page: Router -->
            <div id="page-router" class="page-content">
                <div class="flex justify-between items-center mb-6 border-b border-gray-800 pb-2">
                    <h2 class="text-2xl font-bold">Monitoria MikroTik</h2>
                    <div class="flex gap-2">
                        <button onclick="showProvisionModal()"
                            class="bg-blue-600 hover:bg-blue-500 text-white px-3 py-1 rounded text-xs font-bold transition-all">Provisionar</button>
                        <button onclick="openDeviceModal('ROUTER')"
                            class="bg-neon-green hover:bg-green-500 text-black px-3 py-1 rounded text-xs font-bold transition-all">+
                            Novo MikroTik</button>
                    </div>
                </div>
                <div id="router-container" class="space-y-8"></div>
            </div>

            <!-- Page: Switch -->
            <div id="page-switch" class="page-content">
                <div class="flex justify-between items-center mb-6 border-b border-gray-800 pb-2">
                    <h2 class="text-2xl font-bold">Telemetria Switchs</h2>
                    <button onclick="openDeviceModal('SWITCH')"
                        class="bg-neon-green hover:bg-green-500 text-black px-3 py-1 rounded text-xs font-bold transition-all">+
                        Novo Switch</button>
                </div>
                <div id="switch-container" class="space-y-8"></div>
            </div>

            <!-- Page: Automation -->
            <div id="page-automation" class="page-content">
                <!-- Keep existing automation structure ... -->
                <div class="flex justify-between items-center mb-6">
                    <h2 class="text-2xl font-bold">Automa√ß√£o</h2>
                    <div id="auto-header-actions"><button onclick="openCommandModal()"
                            class="bg-blue-600 hover:bg-blue-500 text-white px-4 py-2 rounded text-xs font-bold transition-all">+
                            Novo Comando</button></div>
                </div>
                <div class="flex gap-6 mb-8 border-b border-gray-800">
                    <button onclick="switchAutoTab('commands')" id="tab-btn-commands"
                        class="pb-3 border-b-2 border-neon-green text-neon-green font-bold text-sm">Comandos
                        R√°pidos</button>
                    <button onclick="switchAutoTab('schedules')" id="tab-btn-schedules"
                        class="pb-3 border-b-2 border-transparent text-gray-500 font-bold text-sm">Agendamentos</button>
                </div>
                <div id="tab-content-commands">
                    <div class="mb-5"><label class="block text-xs font-mono text-gray-500 mb-2 uppercase">1. SELECIONE O
                            EQUIPAMENTO ALVO</label>
                        <div id="automation-device-selector" class="flex gap-3 overflow-x-auto pb-4 scrollbar-hide">
                        </div>
                    </div>
                    <div id="automation-commands-container" class="hidden"><label
                            class="block text-xs font-mono text-gray-500 mb-4 uppercase">2. COMANDOS DISPON√çVEIS</label>
                        <div id="commands-grid" class="grid grid-cols-2 lg:grid-cols-4 gap-4"></div>
                    </div>
                </div>
                <div id="tab-content-schedules" class="hidden">
                    <div class="bg-gray-900 border border-gray-800 rounded-xl overflow-hidden">
                        <table class="w-full text-left text-sm text-gray-400">
                            <tbody id="schedule-list-body" class="divide-y divide-gray-800"></tbody>
                        </table>
                    </div>
                </div>
            </div>

            <!-- Page: Tech, Inventory, Backups, Logs... (Abbreviated for safety, assuming standard containers) -->
            <!-- Note: I will inject the containers for Scripts to populate -->
            <div id="page-tech" class="page-content">
                <h2 class="text-2xl font-bold mb-6 text-neon-green">Portal T√©cnico</h2>
                <div class="grid grid-cols-1 lg:grid-cols-2 gap-6">
                    <div class="bg-gray-900 border border-gray-800 p-4 rounded">
                        <h3 class="text-white font-bold mb-4">ONUs N√£o Configuradas</h3>
                        <div id="unconfigured-list" class="space-y-2"></div>
                    </div>
                </div>
            </div>
            <div id="page-inventory" class="page-content">
                <h2 class="text-2xl font-bold mb-6">Invent√°rio</h2><button onclick="openDeviceModal()"
                    class="bg-neon-green text-black px-4 py-2 rounded font-bold mb-4">+ Novo</button>
                <div class="bg-gray-900 border border-gray-800 rounded overflow-hidden">
                    <table class="w-full text-left text-sm text-gray-400">
                        <tbody id="inventory-list-body"></tbody>
                    </table>
                </div>
            </div>
            <!-- Page: Backups -->
            <div id="page-backups" class="page-content">
                <div class="flex justify-between items-center mb-6">
                    <div>
                        <h2 class="text-2xl font-bold">Gerenciador de Backups</h2>
                        <p class="text-[10px] text-gray-500 uppercase tracking-widest font-mono">Resili√™ncia e Prote√ß√£o
                            de Dados</p>
                    </div>
                    <div class="flex gap-3">
                        <button onclick="testBackup()"
                            class="bg-gray-800 hover:bg-gray-700 text-neon-green border border-neon-green/30 px-4 py-2 rounded text-xs font-bold transition-all flex items-center gap-2">
                            <span>üß™</span> Testar Conex√£o
                        </button>
                        <button onclick="triggerManualBackup()"
                            class="bg-blue-600 hover:bg-blue-500 text-white px-4 py-2 rounded text-xs font-bold shadow-lg shadow-blue-900/50">
                            Executar Backup Manual
                        </button>
                    </div>
                </div>

                <!-- Device Selector for Backups -->
                <div class="mb-8">
                    <label class="block text-[10px] font-mono text-gray-500 mb-4 uppercase tracking-tighter">1.
                        SELECIONE O EQUIPAMENTO PARA VER BACKUPS</label>
                    <div id="backup-device-selector" class="flex gap-4 overflow-x-auto pb-4 scrollbar-hide">
                        <!-- JS Injected Devices -->
                        <div class="animate-pulse flex gap-4">
                            <div class="w-24 h-24 bg-gray-900 rounded-xl border border-gray-800"></div>
                            <div class="w-24 h-24 bg-gray-900 rounded-xl border border-gray-800"></div>
                            <div class="w-24 h-24 bg-gray-900 rounded-xl border border-gray-800"></div>
                        </div>
                    </div>
                </div>

                <!-- Retention Rules (Simplified Display) -->
                <div class="bg-gray-900 border border-gray-800 rounded p-4 mb-6 flex justify-between items-center">
                    <div>
                        <h3 class="text-white font-bold text-sm">Pol√≠tica de Reten√ß√£o Inteligente</h3>
                        <p class="text-[10px] text-gray-500 max-w-2xl">
                            <span class="text-neon-green">Hora em Hora</span> (integral por 1 m√™s) ‚Üí
                            <span class="text-blue-400">12/dia</span> (at√© 3 meses) ‚Üí
                            <span class="text-purple-400">6/dia</span> (at√© 1 ano) ‚Üí
                            <span class="text-yellow-400">1/dia</span> (at√© 3 anos) ‚Üí
                            <span class="text-red-400">1/semana</span> (ap√≥s 3 anos).
                        </p>
                    </div>
                    <div class="text-right">
                        <span class="flex items-center gap-1 text-neon-green text-[10px] font-bold uppercase">
                            <span class="relative flex h-2 w-2">
                                <span
                                    class="animate-ping absolute inline-flex h-full w-full rounded-full bg-neon-green opacity-75"></span>
                                <span class="relative inline-flex rounded-full h-2 w-2 bg-neon-green"></span>
                            </span>
                            Sistema Ativo
                        </span>
                    </div>
                </div>

                <!-- List -->
                <div class="bg-gray-900 border border-gray-800 rounded-xl overflow-hidden">
                    <table class="w-full text-left text-sm text-gray-400">
                        <thead class="bg-gray-950 text-gray-500 uppercase font-mono text-xs">
                            <tr>
                                <th class="p-4">Arquivo</th>
                                <th class="p-4">Equipamento</th>
                                <th class="p-4">Tamanho</th>
                                <th class="p-4">Data</th>
                                <th class="p-4 text-right">A√ß√µes</th>
                            </tr>
                        </thead>
                        <tbody id="backup-list-body" class="divide-y divide-gray-800">
                            <!-- JS Injected -->
                        </tbody>
                    </table>
                </div>
            </div>
            <div id="page-logs" class="page-content">
                <h2 class="text-2xl font-bold mb-6">Syslogs</h2>
                <div id="log-container" class="h-96 overflow-auto bg-gray-900 p-4 font-mono text-xs"></div>
            </div>
            <div id="page-team" class="page-content">
                <h2 class="text-2xl font-bold mb-6">Equipe</h2>
                <div class="bg-gray-900 border border-gray-800 rounded-xl overflow-hidden">
                    <table class="w-full text-left text-sm text-gray-400">
                        <tbody id="user-list-body" class="divide-y divide-gray-800"></tbody>
                    </table>
                </div>
            </div>
            <!-- Page: Revenda -->
            <div id="page-revenda" class="page-content">
                <div class="flex justify-between items-center mb-6 border-b border-gray-800 pb-2">
                    <h2 class="text-2xl font-bold text-yellow-500 uppercase tracking-widest">Painel de Revenda</h2>
                    <span
                        class="text-[10px] bg-yellow-900/50 text-yellow-500 px-2 py-0.5 rounded border border-yellow-800">SUPER
                        ADMIN</span>
                </div>
                <!-- Content to be implemented -->
                <div class="bg-gray-900 border border-gray-800 p-8 rounded-xl text-center">
                    <p class="text-gray-500">M√≥dulo de licenciamento e revenda em desenvolvimento.</p>
                </div>
            </div>

        </main>
    </div>

    <!-- Modals -->
    <!-- Terminal Modal -->
    <div id="terminal-modal"
        class="fixed inset-0 z-[60] flex items-center justify-center bg-black/90 hidden backdrop-blur-sm">
        <div class="bg-brand-gray w-full max-w-5xl h-[80vh] rounded-lg border border-gray-700 shadow-2xl flex flex-col">
            <div class="flex justify-between items-center p-3 border-b border-gray-700 bg-gray-900">
                <span class="text-xs font-mono text-gray-400 flex items-center gap-2">
                    <span class="w-2 h-2 rounded-full bg-green-500 animate-pulse"></span>
                    <span id="term-title">SSH Session</span>
                </span>
                <button onclick="closeTerminal()" class="text-gray-500 hover:text-white px-2 text-xl">&times;</button>
            </div>
            <!-- Xterm Container -->
            <div id="terminal" class="flex-1 bg-black overflow-hidden p-1"></div>
        </div>
    </div>

    <!-- Device Modal (reused) -->
    <div id="device-modal" class="fixed inset-0 z-50 flex items-center justify-center bg-black/80 hidden">
        <div class="bg-brand-gray w-96 p-6 rounded border border-gray-700"><button onclick="closeDeviceModal()"
                class="float-right text-gray-500">x</button>
            <h2 class="text-white text-xl mb-4">Novo Equipamento</h2>
            <form id="device-form" class="space-y-3"><input id="dev-name"
                    class="w-full bg-black border border-gray-700 p-2 text-white" placeholder="Nome"><input id="dev-ip"
                    class="w-full bg-black border border-gray-700 p-2 text-white" placeholder="IP"><select id="dev-type"
                    class="w-full bg-black border border-gray-700 p-2 text-white">
                    <option value="OLT">OLT</option>
                    <option value="ROUTER">Router</option>
                    <option value="SWITCH">Switch</option>
                </select>
                <input id="dev-user" class="w-full bg-black border border-gray-700 p-2 text-white" placeholder="User">
                <div class="flex items-center gap-2 px-1">
                    <input type="checkbox" id="dev-use-key" class="w-4 h-4" onchange="togglePassField()">
                    <label for="dev-use-key" class="text-xs text-gray-400">Usar Chave SSH (Sem Senha)</label>
                </div>
                <input id="dev-pass" type="password" class="w-full bg-black border border-gray-700 p-2 text-white"
                    placeholder="Pass">
                <button class="w-full bg-neon-green text-black font-bold py-2">Salvar</button>
            </form>
        </div>
    </div>

    <!-- Command Modal (reused) -->
    <div id="command-modal" class="fixed inset-0 z-50 flex items-center justify-center bg-black/80 hidden">
        <div class="bg-brand-gray w-96 p-6 rounded border border-gray-700"><button onclick="closeCommandModal()"
                class="float-right text-gray-500">x</button>
            <h2 class="text-white text-xl mb-4">Novo Comando</h2>
            <form id="command-form" class="space-y-3"><input id="cmd-title"
                    class="w-full bg-black border border-gray-700 p-2 text-white" placeholder="T√≠tulo"><textarea
                    id="cmd-raw" class="w-full bg-black border border-gray-700 p-2 text-white"
                    placeholder="Comando"></textarea><button
                    class="w-full bg-blue-600 text-white font-bold py-2">Salvar</button></form>
        </div>
    </div>

    <!-- MikroTik Style Terminal Diagnosis Modal -->
    <div id="test-result-modal"
        class="fixed inset-0 z-[120] flex items-center justify-center bg-black/95 hidden backdrop-blur-sm">
        <div id="test-window"
            class="bg-[#0c0c0c] w-full max-w-3xl rounded-lg border-2 shadow-[0_0_50px_rgba(0,0,0,0.8)] overflow-hidden transition-colors duration-500">
            <!-- Terminal Header / Title Bar -->
            <div id="test-header" class="px-4 py-2 flex justify-between items-center border-b select-none">
                <div class="flex items-center gap-2">
                    <span class="text-[10px] font-bold tracking-widest uppercase opacity-80"
                        id="test-window-title">MikroTik Terminal Diagnosis</span>
                </div>
                <button onclick="closeTestResultModal()"
                    class="text-white/50 hover:text-white transition-colors text-xl font-bold">&times;</button>
            </div>

            <div class="p-6 font-mono">
                <!-- MikroTik ASCII Header -->
                <pre class="text-[9px] leading-none mb-6 opacity-60 text-white">
  MMM      MMM       KKK                          TTTTTTTTTTT  KKK
  NMMN    NMMN       KKK                          TTTTTTTTTTT  KKK
  NNMMN  NMMMN  III  KKK  KKKK  RRRRRR    OOOOOO      TTT      KKK  KKKK
  NNNMMNNMMMNN  III  KKKKK      RRR  RR  OOO  OOO     TTT      KKKKK
  NNN MMMMM NN  III  KKK KKK    RRRRRR   OOO  OOO     TTT      KKK KKK
  NNN  MMM  NN  III  KKK  KKKK  RRR  RR   OOOOOO      TTT      KKK  KKKK
                </pre>

                <!-- Terminal Content -->
                <div class="space-y-4 text-[12px]">
                    <div class="flex gap-2">
                        <span class="text-neon-green" id="terminal-prompt">[admin@MikroTik] &gt;</span>
                        <span class="text-white" id="test-command">/system backup save name=test_connection</span>
                    </div>

                    <div class="pt-2 border-t border-white/5">
                        <div class="text-gray-500 mb-2 uppercase text-[9px] font-bold tracking-widest">System Output:
                        </div>
                        <div id="test-output" class="whitespace-pre-wrap leading-relaxed min-h-[100px] text-gray-300">
                        </div>
                    </div>

                    <div id="test-summary-box" class="mt-6 p-4 rounded bg-white/5 border border-white/10">
                        <div class="flex items-center gap-3">
                            <div id="test-status-indicator" class="w-3 h-3 rounded-full animate-pulse"></div>
                            <span id="test-status-text"
                                class="font-bold uppercase tracking-widest text-[11px]">Calculando...</span>
                        </div>
                    </div>
                </div>
            </div>

            <div class="bg-black/50 px-6 py-4 flex justify-end gap-3 border-t border-white/5">
                <button onclick="closeTestResultModal()"
                    class="px-6 py-2 bg-white/10 hover:bg-white/20 text-white text-xs font-bold rounded transition-all uppercase">Fechar
                    Terminal</button>
            </div>
        </div>
    </div>

    <!-- Provision Modal -->
    <div id="provision-modal"
        class="fixed inset-0 z-[100] flex items-center justify-center bg-black/90 hidden backdrop-blur-md">
        <div class="bg-brand-gray w-full max-w-2xl p-8 rounded-xl border border-gray-700 shadow-2xl relative">
            <button onclick="closeProvisionModal()"
                class="absolute top-4 right-4 text-gray-500 hover:text-white text-2xl">&times;</button>
            <div class="flex items-center gap-3 mb-6">
                <div
                    class="w-10 h-10 bg-blue-600/20 text-blue-500 rounded-full flex items-center justify-center text-xl">
                    üìú</div>
                <div>
                    <h2 class="text-white text-xl font-bold">Script de Provisionamento</h2>
                    <p class="text-[10px] text-gray-500 uppercase tracking-widest font-mono">MikroTik RouterOS Setup</p>
                </div>
            </div>
            <p class="text-sm text-gray-400 mb-4">Execute este script no terminal do seu MikroTik (<span
                    class="text-blue-400">/terminal</span>) para configurar o acesso seguro e monitoramento.</p>
            <textarea id="provision-script"
                class="w-full bg-black border border-gray-800 p-4 text-[10px] font-mono text-neon-green h-80 mb-6 rounded-lg scrollbar-hide focus:border-blue-500 outline-none transition-all"
                readonly></textarea>
            <div class="flex gap-3">
                <button onclick="copyProvisionScript()"
                    class="flex-1 bg-blue-600 hover:bg-blue-500 text-white font-bold py-3 rounded-lg transition-all shadow-lg shadow-blue-900/40">Copiar
                    Script</button>
                <button onclick="closeProvisionModal()"
                    class="px-6 py-3 border border-gray-700 text-gray-400 hover:text-white hover:border-white rounded-lg transition-all">Fechar</button>
            </div>
        </div>
    </div>

    <script>
        const API_BASE = '/api/v1';
        let term = null;
        let ws = null;

        // Login
        document.getElementById('login-form').addEventListener('submit', async (e) => {
            e.preventDefault();
            const u = document.getElementById('username').value;
            const p = document.getElementById('password').value;
            try {
                const res = await fetch('/api/login', {
                    method: 'POST',
                    body: JSON.stringify({ username: u, password: p, role: 'admin' })
                });
                if (res.ok) {
                    const data = await res.json();
                    localStorage.setItem('token', data.token);
                    document.getElementById('login-screen').classList.add('hidden');
                    document.getElementById('app-container').classList.remove('hidden');
                    loadMe();
                    showPage('olt'); // Default
                } else {
                    document.getElementById('login-error').classList.remove('hidden');
                }
            } catch (e) { console.error(e); }
        });

        async function loadMe() {
            const token = localStorage.getItem('token');
            const res = await fetch(`${API_BASE}/me`, { headers: { 'Authorization': `Bearer ${token}` } });
            const user = await res.json();
            document.getElementById('user-display').innerText = user.full_name || user.username;
            document.getElementById('avatar').innerText = (user.username || 'AD').substring(0, 2).toUpperCase();
            if (user.role === 'admin' || user.role === 'sairo') document.getElementById('nav-super-admin').classList.remove('hidden');
        }

        let selectedBackupDeviceId = null;

        // Navigation
        function showPage(pageId) {
            console.log('Switching to:', pageId);

            // 1. Hide everything with class page-content
            document.querySelectorAll('.page-content').forEach(p => {
                p.classList.remove('active');
                p.classList.add('hidden'); // Double safety
            });

            // 2. Show the target page
            const target = document.getElementById('page-' + pageId);
            if (target) {
                target.classList.add('active');
                target.classList.remove('hidden');
            } else {
                console.warn('Page not found:', pageId);
            }

            // 3. Load specific data based on page
            switch (pageId) {
                case 'olt': loadDevices('olt'); break;
                case 'router': loadDevices('router'); break;
                case 'switch': loadDevices('switch'); break;
                case 'inventory': loadInventory(); break;
                case 'tech': loadTechDashboard(); break;
                case 'backups': loadBackupDevices(); loadBackups(); break;
                case 'logs': loadLogs(); break;
                case 'team': loadUsers(); break;
                case 'revenda': /* Future */ break;
            }
        }

        async function loadBackups(deviceId = null) {
            try {
                // Toggle Logic
                if (deviceId && selectedBackupDeviceId === deviceId) {
                    selectedBackupDeviceId = null;
                } else if (deviceId) {
                    selectedBackupDeviceId = deviceId;
                }

                const url = selectedBackupDeviceId ? `${API_BASE}/backups?device_id=${selectedBackupDeviceId}` : `${API_BASE}/backups`;
                const res = await fetch(url, { headers: { 'Authorization': 'Bearer ' + localStorage.getItem('token') } });
                const backups = await res.json();
                const container = document.getElementById('backup-list-body');

                // Update selector visual state
                document.querySelectorAll('.backup-device-card').forEach(card => {
                    card.classList.remove('border-neon-green', 'bg-neon-green/5', 'shadow-[0_0_15px_rgba(0,255,65,0.1)]');
                    if (card.getAttribute('data-id') === selectedBackupDeviceId) {
                        card.classList.add('border-neon-green', 'bg-neon-green/5', 'shadow-[0_0_15px_rgba(0,255,65,0.1)]');
                    }
                });

                if (backups.length === 0) {
                    container.innerHTML = `<tr><td colspan="5" class="p-12 text-center">
                        <div class="text-gray-600 mb-2">üì≠</div>
                        <div class="text-gray-500 text-xs italic">Nenhum backup encontrado para este equipamento.</div>
                    </td></tr>`;
                    return;
                }

                container.innerHTML = backups.filter(b => !deviceId || b.device_id === deviceId).map(b => `
                    <tr class="hover:bg-white/5 transition-colors group">
                        <td class="p-4 text-white font-mono text-xs">
                             <div class="flex items-center gap-3">
                                <span class="p-2 bg-gray-800 rounded group-hover:bg-blue-900 transition-colors">üìÑ</span>
                                <div>
                                    <div class="font-bold">${b.filename}</div>
                                    <div class="text-[9px] text-gray-500 uppercase">${b.id}</div>
                                </div>
                             </div>
                        </td>
                        <td class="p-4 text-gray-300">
                             <span class="px-2 py-1 bg-gray-800 rounded-full text-[10px] font-bold text-gray-400">${b.device_name || 'MikroTik'}</span>
                        </td>
                        <td class="p-4 font-mono text-xs text-blue-400 font-bold">${b.size}</td>
                        <td class="p-4 text-xs text-gray-500">${b.created_at}</td>
                        <td class="p-4 text-right">
                            <button class="text-blue-400 hover:text-white text-xs mr-4 transition-colors font-bold uppercase tracking-tighter">Download</button>
                            <button onclick="deleteBackup('${b.id}')" class="text-red-900 hover:text-red-500 text-xs transition-colors font-bold uppercase tracking-tighter">Excluir</button>
                        </td>
                    </tr>
                `).join('');
            } catch (e) { console.error(e); }
        }

        async function loadBackupDevices() {
            try {
                const res = await fetch(`${API_BASE}/devices`, { headers: { 'Authorization': 'Bearer ' + localStorage.getItem('token') } });
                const devices = await res.json();
                const container = document.getElementById('backup-device-selector');
                if (!container) return;

                container.innerHTML = devices.map(d => `
                    <div onclick="loadBackups('${d.id}')" 
                         data-id="${d.id}"
                         class="backup-device-card min-w-[120px] bg-gray-900 border border-gray-800 p-4 rounded-xl cursor-pointer hover:border-gray-500 transition-all flex flex-col items-center gap-2 group">
                        <div class="text-2xl group-hover:scale-110 transition-transform">${d.type === 'olt' ? 'üì°' : d.type === 'switch' ? 'üîå' : 'üì†'}</div>
                        <div class="text-[10px] font-bold text-white text-center truncate w-full">${d.name}</div>
                        <div class="text-[9px] text-gray-600 font-mono">${d.ip}</div>
                    </div>
                `).join('');
            } catch (e) { console.error(e); }
        }

        async function testBackup() {
            if (!selectedBackupDeviceId) {
                alert("Selecione um equipamento primeiro!");
                return;
            }

            const btn = event.currentTarget;
            const originalText = btn.innerHTML;
            btn.innerHTML = '<span>‚è≥</span> Testando...';
            btn.disabled = true;

            try {
                const res = await fetch(`${API_BASE}/backups/test`, {
                    method: 'POST',
                    headers: { 'Authorization': 'Bearer ' + localStorage.getItem('token'), 'Content-Type': 'application/json' },
                    body: JSON.stringify({ device_id: selectedBackupDeviceId })
                });
                const result = await res.json();

                showTestResult(result);
                if (result.success) loadBackups(selectedBackupDeviceId);
            } catch (e) {
                showTestResult({
                    success: false,
                    message: "Erro de Comunica√ß√£o",
                    details: "N√£o foi poss√≠vel conectar ao servidor da API para realizar o diagn√≥stico.",
                    command: "PING API /backups/test"
                });
            } finally {
                btn.innerHTML = originalText;
                btn.disabled = false;
            }
        }

        function showTestResult(res) {
            const modal = document.getElementById('test-result-modal');
            const windowEl = document.getElementById('test-window');
            const header = document.getElementById('test-header');
            const statusText = document.getElementById('test-status-text');
            const statusIndicator = document.getElementById('test-status-indicator');
            const output = document.getElementById('test-output');
            const cmd = document.getElementById('test-command');

            if (res.success) {
                windowEl.className = "bg-[#0c0c0c] w-full max-w-3xl rounded-lg border-2 border-green-600 shadow-[0_0_50px_rgba(22,163,74,0.3)] overflow-hidden transition-all duration-500";
                header.className = "px-4 py-2 flex justify-between items-center border-b border-green-900/50 bg-green-950/30 text-green-400 select-none";
                statusText.innerText = "Diagn√≥stico: SUCESSO";
                statusText.className = "font-bold uppercase tracking-widest text-[11px] text-green-400";
                statusIndicator.className = "w-3 h-3 rounded-full bg-green-500 animate-pulse";
            } else {
                windowEl.className = "bg-[#0c0c0c] w-full max-w-3xl rounded-lg border-2 border-red-600 shadow-[0_0_50px_rgba(220,38,38,0.3)] overflow-hidden transition-all duration-500";
                header.className = "px-4 py-2 flex justify-between items-center border-b border-red-900/50 bg-red-950/30 text-red-400 select-none";
                statusText.innerText = "Diagn√≥stico: FALHA CR√çTICA";
                statusText.className = "font-bold uppercase tracking-widest text-[11px] text-red-400";
                statusIndicator.className = "w-3 h-3 rounded-full bg-red-500 animate-pulse";
            }

            cmd.innerText = res.command || "/system backup save name=test_connection";
            output.innerText = `${res.message}\n\nDETAILS:\n${res.details || 'No additional system logs.'}\n\nConnection check completed at ${new Date().toLocaleTimeString()}`;

            modal.classList.remove('hidden');
        }

        function closeTestResultModal() {
            document.getElementById('test-result-modal').classList.add('hidden');
        }

        // Removed old showNotification alerts to prioritize Terminal UI

        async function triggerManualBackup() {
            if (!selectedBackupDeviceId) {
                alert("Por favor, selecione um equipamento na lista acima para realizar o backup.");
                return;
            }

            const btn = event.currentTarget;
            const originalText = btn.innerHTML;
            btn.innerHTML = '<span>‚è≥</span> Iniciando...';
            btn.disabled = true;

            try {
                const res = await fetch(`${API_BASE}/backups/manual`, {
                    method: 'POST',
                    headers: { 'Authorization': 'Bearer ' + localStorage.getItem('token'), 'Content-Type': 'application/json' },
                    body: JSON.stringify({ device_id: selectedBackupDeviceId })
                });

                if (res.ok) {
                    showNotification('Backup Gerado', 'O backup manual foi conclu√≠do com sucesso.', 'success');
                    loadBackups(selectedBackupDeviceId); // Refresh list for this device
                } else {
                    showNotification('Falha no Backup', 'N√£o foi poss√≠vel gerar o backup manual.', 'error');
                }
            } catch (e) {
                console.error(e);
                showNotification('Erro de Rede', 'Erro ao tentar realizar backup.', 'error');
            } finally {
                btn.innerHTML = originalText;
                btn.disabled = false;
            }
        }

        async function deleteBackup(id) {
            if (!confirm("Remover este backup permanentemente?")) return;
            const res = await fetch(`${API_BASE}/backups?id=${id}`, {
                method: 'DELETE',
                headers: { 'Authorization': 'Bearer ' + localStorage.getItem('token') }
            });
            if (res.ok) {
                loadBackups();
            } else {
                alert("Erro ao remover backup.");
            }
        }

        async function loadDevices(type) {
            const token = localStorage.getItem('token');
            if (!token) return;
            const res = await fetch(`${API_BASE}/devices`, { headers: { 'Authorization': 'Bearer ' + token } });
            const devices = await res.json();

            if (type === 'olt') renderOLT(devices.filter(d => d.type === 'OLT'));
            if (type === 'router') renderRouter(devices.filter(d => d.type === 'ROUTER'));
            if (type === 'switch') renderSwitch(devices.filter(d => d.type === 'SWITCH'));
        }

        async function renderOLT(devices) {
            const container = document.getElementById('olt-container');
            container.innerHTML = '';

            // For each OLT, fetch Stats
            for (const d of devices) {
                // Fetch density (mocked for now as we don't have id-based density endpoint yet, using global one or specific)
                // User asked for /api/olt/stats, assuming global or specific.
                // Let's use the one we created: GetOltStatsHandler (global mock)
                const statsRes = await fetch(`${API_BASE}/olt/stats`, { headers: { 'Authorization': 'Bearer ' + localStorage.getItem('token') } });
                const stats = await statsRes.json();

                const html = `
                    <div class="bg-gray-900 border border-gray-800 rounded-xl overflow-hidden mb-6">
                        <div class="p-4 border-b border-gray-800 bg-black/40 flex justify-between items-center">
                            <div class="flex items-center gap-3">
                                <span class="text-2xl">üì°</span>
                                <div>
                                    <h3 class="font-bold text-lg text-white">${d.name}</h3>
                                    <div class="text-xs text-gray-500 font-mono">${d.ip}</div>
                                </div>
                            </div>
                            <button onclick="openTerminal('${d.ip}', '${d.username}', '${d.password || ""}', '', ${d.use_ssh_key || false})" class="bg-gray-800 hover:bg-gray-700 px-3 py-1 rounded text-xs font-mono text-neon-green border border-gray-700">
                                >_ Console
                            </button>
                        </div>
                        <div class="p-6">
                            <h4 class="text-xs uppercase text-gray-500 font-bold mb-4">Densidade de Portas PON</h4>
                            <div class="grid grid-cols-4 md:grid-cols-8 gap-2">
                                ${stats.port_density.map(p => {
                    const percent = (p.connected_clients / p.total_slots) * 100;
                    const color = percent > 90 ? 'bg-red-500' : percent > 50 ? 'bg-yellow-500' : 'bg-neon-green';
                    return `
                                    <div class="bg-black border border-gray-800 rounded p-2 text-center group hover:border-white transition-colors cursor-pointer" title="${p.connected_clients} Clientes">
                                        <div class="text-[10px] text-gray-500 mb-1">${p.port}</div>
                                        <div class="h-12 w-full bg-gray-800 rounded relative overflow-hidden">
                                            <div class="absolute bottom-0 left-0 w-full ${color}" style="height: ${percent}%"></div>
                                        </div>
                                        <div class="text-xs font-bold text-white mt-1">${p.connected_clients}</div>
                                    </div>
                                    `;
                }).join('')}
                            </div>
                        </div>
                    </div>
                 `;
                container.innerHTML += html;
            }
        }

        function renderRouter(devices) {
            const container = document.getElementById('router-container');
            if (!container) return;
            container.innerHTML = devices.map(d => `
                <div class="bg-gray-900 border border-gray-800 p-4 rounded flex justify-between items-center">
                    <div>
                        <div class="text-neon-green font-bold text-lg">${d.name}</div>
                        <div class="text-gray-500 font-mono text-sm">${d.ip}</div>
                    </div>
                    <button onclick="openTerminal('${d.ip}', '${d.username}', '${d.password || ""}', '/system resource print', ${d.use_ssh_key || false})" class="text-neon-green hover:underline">CLI</button>
                </div>
            `).join('');
        }

        function renderSwitch(devices) {
            const container = document.getElementById('switch-container');
            container.innerHTML = devices.map(d => `
                <div class="bg-gray-900 border border-gray-800 p-4 rounded flex justify-between items-center">
                    <div>
                        <div class="text-purple-400 font-bold text-lg">${d.name}</div>
                        <div class="text-gray-500 font-mono text-sm">${d.ip}</div>
                    </div>
                     <button onclick="openTerminal('${d.ip}', '${d.username}', '${d.password || ""}', '/interface print', ${d.use_ssh_key || false})" class="text-purple-400 hover:underline">CLI</button>
                </div>
            `).join('');
        }

        // Terminal & WebSocket
        function openTerminal(host, user, pass, cmd, useKey) {
            document.getElementById('terminal-modal').classList.remove('hidden');
            document.getElementById('term-title').innerText = `${user}@${host}`;

            if (term) term.dispose();
            term = new Terminal({
                cursorBlink: true,
                theme: { background: '#000000', foreground: '#00ff41' },
                fontFamily: 'Courier New, monospace',
                fontSize: 14,
            });
            const fitAddon = { fit: () => { } }; // Mock FitAddon if not verifying loaded, else use CDN
            // Assuming FitAddon not loaded to keep simple, fixed size
            term.open(document.getElementById('terminal'));

            term.writeln('Connecting to remote host...');

            // WS Connection
            // Determine protocol (ws or wss)
            const proto = window.location.protocol === 'https:' ? 'wss' : 'ws';
            const token = localStorage.getItem('token');
            ws = new WebSocket(`${proto}://${window.location.host}/api/v1/ws?token=${token}`);

            ws.onopen = () => {
                term.writeln('Connected via Secure WebSocket.');
                term.writeln('Authentication...');

                // Send payload
                const payload = {
                    host: host,
                    port: 22,
                    user: user || '',
                    password: pass || '',
                    command: cmd || '/system identity print',
                    use_ssh_key: useKey || false
                };
                ws.send(JSON.stringify(payload));
            };

            ws.onmessage = (event) => {
                // Determine if we need to format lines from JSON or raw
                // Our Go backend sends lines as text messages
                term.write(event.data.replace(/\n/g, '\r\n'));
            };

            ws.onerror = (e) => {
                term.writeln('\r\nConnection Error.');
            };

            ws.onclose = () => {
                term.writeln('\r\nSession Closed.');
            };
        }

        function closeTerminal() {
            document.getElementById('terminal-modal').classList.add('hidden');
            if (ws) ws.close();
            if (term) term.dispose();
        }

        // Other basic handlers (Inventory, etc)
        async function loadInventory() {
            try {
                const res = await fetch(`${API_BASE}/devices`, { headers: { 'Authorization': 'Bearer ' + localStorage.getItem('token') } });
                const devices = await res.json();
                const container = document.getElementById('inventory-list-body');
                if (!container) return;
                container.innerHTML = devices.map(d => `
                  <tr class="border-b border-gray-800 hover:bg-gray-800/50 transition-colors">
                    <td class="p-4">
                        <div class="font-bold text-white">${d.name}</div>
                        <div class="text-[10px] text-gray-500 uppercase font-mono">${d.type}</div>
                    </td>
                    <td class="p-4 font-mono text-xs">${d.ip}</td>
                    <td class="p-4 text-xs text-gray-400">
                        <span class="text-[10px] text-gray-600">USER:</span> ${d.username}<br>
                        <span class="text-[10px] text-gray-600">PASS:</span> ${d.password ? '‚Ä¢‚Ä¢‚Ä¢‚Ä¢‚Ä¢' : '<span class="text-red-500">MISSING</span>'}
                    </td>
                    <td class="p-4 text-right">
                        <button onclick="deleteDevice('${d.id}')" class="text-red-500 hover:text-red-400 text-[10px] uppercase font-bold border border-red-900/50 px-2 py-1 rounded">Remover</button>
                    </td>
                  </tr>`
                ).join('');
            } catch (e) { console.error('Error loading inventory:', e); }
        }

        async function loadUsers() {
            try {
                const res = await fetch(`${API_BASE}/users`, { headers: { 'Authorization': 'Bearer ' + localStorage.getItem('token') } });
                const users = await res.json();
                const container = document.getElementById('user-list-body');
                if (!container) return;
                container.innerHTML = users.map(u => `
                    <tr class="border-b border-gray-800">
                        <td class="p-4">
                            <div class="font-bold text-white">${u.full_name || u.username}</div>
                            <div class="text-[10px] text-gray-500">@${u.username}</div>
                        </td>
                        <td class="p-4">
                            <span class="px-2 py-0.5 rounded text-[10px] font-bold uppercase ${u.role === 'admin' ? 'bg-red-900 text-red-200' : 'bg-blue-900 text-blue-200'}">${u.role}</span>
                        </td>
                        <td class="p-4 text-right">
                             <button class="text-gray-500 hover:text-white text-xs">Editar</button>
                        </td>
                    </tr>
                `).join('');
            } catch (e) { console.error('Error loading team:', e); }
        }

        async function loadTechDashboard() {
            try {
                const res = await fetch(`${API_BASE}/onus/unregistered`, { headers: { 'Authorization': 'Bearer ' + localStorage.getItem('token') } });
                const onus = await res.json();
                const container = document.getElementById('unconfigured-list');
                if (!container) return;
                container.innerHTML = onus.map(o => `
                    <div class="bg-black border border-gray-800 p-3 rounded flex justify-between items-center group hover:border-neon-green transition-all">
                        <div>
                            <div class="text-xs font-mono text-neon-green font-bold">${o.serial_number}</div>
                            <div class="text-[10px] text-gray-500">Porta: ${o.pon_port} | Sinal: ${o.signal_dbm}dBm</div>
                        </div>
                        <button class="bg-neon-green text-black px-2 py-1 rounded text-[10px] font-bold uppercase">Autorizar</button>
                    </div>
                `).join('') || '<div class="text-gray-600 text-xs italic">Nenhuma ONU pendente.</div>';
            } catch (e) { console.error('Error loading tech dashboard:', e); }
        }

        async function loadLogs() {
            try {
                const res = await fetch(`${API_BASE}/logs`, { headers: { 'Authorization': 'Bearer ' + localStorage.getItem('token') } });
                const logs = await res.json();
                const container = document.getElementById('log-container');
                if (!container) return;
                container.innerHTML = logs.map(l => `
                    <div class="mb-1">
                        <span class="text-gray-600">[${new Date(l.timestamp).toLocaleTimeString()}]</span>
                        <span class="text-blue-400">${l.device_ip}</span>: 
                        <span class="text-gray-300">${l.message}</span>
                    </div>
                `).join('') || '<div class="text-gray-600 italic">Sem logs registrados.</div>';
            } catch (e) { console.error('Error loading logs:', e); }
        }

        async function deleteDevice(id) {
            if (!confirm('Tem certeza que deseja remover este equipamento?')) return;
            const res = await fetch(`${API_BASE}/devices?id=${id}`, {
                method: 'DELETE',
                headers: { 'Authorization': 'Bearer ' + localStorage.getItem('token') }
            });
            if (res.ok) {
                loadInventory();
                // Refresh other pages that depend on devices
                loadDevices('olt');
                loadDevices('router');
                loadDevices('switch');
            } else {
                alert('Erro ao remover. Verifique se voc√™ √© o dono.');
            }
        }

        function openDeviceModal(type) {
            document.getElementById('device-modal').classList.remove('hidden');
            if (type) {
                document.getElementById('dev-type').value = type;
            }
        }
        function closeDeviceModal() { document.getElementById('device-modal').classList.add('hidden'); }

        document.getElementById('device-form').addEventListener('submit', async (e) => {
            e.preventDefault();
            await fetch(`${API_BASE}/devices`, {
                method: 'POST',
                headers: { 'Authorization': 'Bearer ' + localStorage.getItem('token'), 'Content-Type': 'application/json' },
                body: JSON.stringify({
                    name: document.getElementById('dev-name').value,
                    ip: document.getElementById('dev-ip').value,
                    type: document.getElementById('dev-type').value,
                    username: document.getElementById('dev-user').value,
                    password: document.getElementById('dev-use-key').checked ? "" : document.getElementById('dev-pass').value,
                    use_ssh_key: document.getElementById('dev-use-key').checked
                })
            });
            closeDeviceModal();
            loadInventory();
        });

        function togglePassField() {
            const useKey = document.getElementById('dev-use-key').checked;
            const passField = document.getElementById('dev-pass');
            if (useKey) {
                passField.classList.add('hidden');
                passField.value = "";
                showProvisionModal(); // Auto open provision script
            } else {
                passField.classList.remove('hidden');
            }
        }

        async function showProvisionModal() {
            const token = localStorage.getItem('token');
            const res = await fetch(`${API_BASE}/provision`, {
                headers: { 'Authorization': 'Bearer ' + token }
            });
            if (res.ok) {
                const data = await res.json();
                document.getElementById('provision-script').value = data.script;
                document.getElementById('provision-modal').classList.remove('hidden');
                // Ensure z-index is high enough if called from another modal
                document.getElementById('provision-modal').style.zIndex = "100";
            } else {
                alert("Erro ao carregar script de provisionamento. Verifique se o servidor est√° online.");
            }
        }

        function closeProvisionModal() {
            document.getElementById('provision-modal').classList.add('hidden');
        }

        function copyProvisionScript() {
            const copyText = document.getElementById('provision-script');
            copyText.select();
            document.execCommand("copy");
            alert("Script copiado!");
        }

    </script>
</body>

</html>